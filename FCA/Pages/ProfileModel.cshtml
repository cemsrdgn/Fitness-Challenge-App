@page
@model FCA.Pages.ProfileModel
@{
    ViewData["Title"] = "Profile";
}

<link rel="stylesheet" href="~/css/Profile.css">

<main role="main" class="container" style="margin-top: 130px;">
    <div class="profile-header text-center">
        <img src="https://img.freepik.com/free-vector/businessman-character-avatar-isolated_24877-60111.jpg?size=338&ext=jpg&ga=GA1.1.2082370165.1716422400&semt=ais_user" class="profile-img" alt="Profile Picture">
        <h1>@User.Identity.Name</h1>
        <p class="short-bio">
            <span id="bio-text">@Model.ShortBio</span>
            <span id="bio-edit" style="cursor: pointer;">
                <i class="fa fa-edit"></i>
            </span>
            <form id="bio-form" method="post" asp-page-handler="UpdateBio" style="display: none;">
                <input type="text" name="ShortBio" value="@Model.ShortBio" class="form-control" />
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-check"></i>
                </button>
            </form>
        </p>
    </div>

    <div class="favorite-challenges">
        <h2>Favorite Challenges</h2>
        @if (Model.FavoriteChallenges != null && Model.FavoriteChallenges.Any())
        {
            <ul class="challenge-list">
                @foreach (var challenge in Model.FavoriteChallenges)
                {
                    <li>
                        <strong>@challenge.Category:</strong> @challenge.Instruction
                    </li>
                }
            </ul>
        }
        else
        {
            <p>No favorite challenges added yet.</p>
        }
    </div>

    <div class="email-update">
        <p>(Need to log in again in case of changes)</p>
        <h2>Update Email</h2>
        <form method="post" asp-page-handler="UpdateEmail">
            <div class="form-group">
                <label for="email">New Email</label>
                <input type="email" id="email" name="Email" class="form-control" value="@Model.Email" required />
            </div>
            <button type="submit" class="btn btn-primary">Update Email</button>
        </form>
    </div>

    <div class="password-update" style="margin-bottom: 30px;">
        <h2>Update Password</h2>
        <form method="post" asp-page-handler="UpdatePassword">
            <div class="form-group">
                <label for="password">New Password</label>
                <input type="password" id="password" name="Password" class="form-control" required />
            </div>
            <button type="submit" class="btn btn-primary">Update Password</button>
        </form>
    </div>
</main>

<script>
    document.getElementById('bio-edit').addEventListener('click', function() {
        document.getElementById('bio-text').style.display = 'none';
        document.getElementById('bio-edit').style.display = 'none';
        document.getElementById('bio-form').style.display = 'block';
    });
</script>
